(base) mjgp@alpha:~/ExamplePDBs/7TFS$ python3 BioDC.py 

 ================================================================== 
                      Weclome to BioDC
           A program that automates and accelerates
             the computation of redox currents in
              (polymeric) multi-heme cytochormes 

            Written by Matthew J. Guberman-Pfeffer
                Last Updated: 05/28/2023

 This research was supported by the National Institute of General 
 Medical Sciences of the National Institutes of Health under award
 1F32GM142247-01A1.
 ================================================================== 

 BioDC presents a highly modular workflow that has three 
 large divisions: 
    (1) Structure Preparaiton & Relaxation
    (2) Energetic Estimation
    (3) Redox Current Prediction
 
 Which of these divisions would you like to perform?
 (Enter zero "0" to be guided through the entire
 workflow.) (0/1/2/3) 0

 ===================================================================  
 First: Structure Preparation & Relaxation
 ===================================================================  
     
 This program requires VMD and the AmberTools package to be 
 in your system's PATH variable. Are they? (yes/no)? y
 
 Good! Now, here are the PDBs in the present direcotry:

7TFS_3.pdb
7TFS_Breres.pdb
7TFS_1.pdb
7TFS_Areres.pdb
7TFS_5.pdb
7TFS_preped.pdb
HEC.pdb
7TFS_2.pdb
7TFS_Dreres.pdb
7TFS_C.pdb
7TFS_trimer.pdb
prot.pdb
7TFS_Creres.pdb
7TFS_7.pdb
7TFS_D.pdb
7TFS_A.pdb
7TFS_4.pdb
7TFS.pdb
7TFS_B.pdb
7TFS_trimer_reord.pdb
7TFS_6.pdb

 Which PDB would you like to setup 
 (omit the .pdb file extension)? 7TFS_preped
 That PDB was found! 

 We need to create a file (ResIndexing.txt) that identifies 
 the IDs of the Cys and His residues bound to the heme macrocycle.
 Would you like to create it automatically or manually (auto/man)? auto

 The automated creation of ResIndexing.txt has two parts:
   1) Writting CreateResIndexing.tcl 
   2) Submitting the TCL script to Visual Molecular Dynamics (VMD)

 The TCL script identifies the Cys and His residues within a 
 distance cutoff of each heme group and assumes that the residues 
 found within that cutoff are bonded to that heme.

 What distance threshold would you liek to use? 
 (recommended = 2.5 angstroms)                  2.5

 Please make sure that the correct residues are identified by, 
 for example, creating representations in VMD with the residue IDs 
 givenon each line of the ResIndexing.txt file. 

 If the wrong residues are identified, the setup later with TLEaP 
 will fail because the bond definitions will be wrong. In this case, 
 please correct the residue IDs and save the changes to 
 CorrectedResIndexing.txt. When you re-run this python scirpt, the
 CorrectedResIndexing.txt file will be detected and used to replace
 ResIndexing.txt. 
                
rlwrap: Command not found.

 Your ResIndexing file will now be used with VMD
 to create the HEH, HIO, and CYO residues.
 
 We will write and submit a script called SetupStructure.tcl to 
 perform this magic.

 CAUTION: The magic of the script is only as good as the information 
 in ResIndexing.txt. If the wrong residue IDs are specified, 
 everything from hereon out will be, put politely, junk!
      
 Shall we venture forward with SetupStructure.tcl (yes/no)? y
rlwrap: Command not found.

 VMD finished. Please check SetupStructure.log for any erros. You may 
 also want to inspect the generated PDBs for the protein,each heme, 
 and each heme propionic acid group.
             
 Now, we need to stitch the edited PDBs of the protein, hemes, 
 and heme propionic acid groups into a single PDB. Then, this 
 re-constructed PDB of the multi-heme protein will be processed
 with TLEaP of the AmberTools package to generate topology and 
 coordinate files.
      
 Prefix for output parm/rst7 7TFS
 Should the structure be prepared with 
 an explicit or implicit solvent (explicit/implicit)? e
  Using a rectangular or an octahedral box (rec/octahed)? rec
  With how much of a solvent buffer (in angstroms)? 15
  And how many Na+ ions; 0 = enough for charge neutrality? 0
  And how many Cl- ions; 0 = enough for charge neutrality? 0

 The re-compiled structure will now be processed with TLEaP.
     
 TLEaP finished! 
 Please inspect the structure to make sure it is correct.
    
 Found 7TFS.prmtop and 7TFS.rst7
 Preparing to relax the geometry
 Running minimization ...
 Minimization finished!

 ===================================================================  
 Second: Energetic Estimation
 ===================================================================


 Is your structure polymeric (yes/no)? y

 The structure preparation stage required you to place all the heme
 residues from all the chains at the end of the PDB with sequential
 numbering. The programs in AmberTools that will be used to estimate 
 the charge transfer energetics want instead the residues to come in 
 the order of the connectiviity; that is, the hemes of chain A should 
 come both any residue in chain B. 

 To oblige this different numbering convention, we'll use the 
 CPPTRAJ of the AmberTools package to re-order the residues. 
 This process will write a new topology and coordinate file, 
 where the latter is of the structure you previously minimized.

 To compute the energetics for heme-to-heme electron transfer. We 
 need to know the linear sequence of hemes that will serve as 
 charge hopping sites. Typically the linear sequence is NOT the 
 sequence of residue IDs in the PDB. We therefore need to specify
 the linear sequence to compute the right electron transfer steps. 
    
 Linear Sequence: 651 654 657 660 639
 ------------------------------------------------------------------- 

 Should we compute the reorganization energy (yes/no)? y
 Found 7TFS_reord.prmtop and min.rst7

 To estimate the reorganization energy (lambda) from the 
 solvent accessible surface area, two steps will be take:
    (1) Convert min.rst7 to a PDB-formatted file using ambpdb 
        Note: This step is skipped because you indicated you 
        have a polymeric structute, When the topology was
        re-ordered to conform to AMBER conventions for 
        multi-chain structures, min.pdb was already 
        created.
             
    (2) Write and submit a TCL script to VMD
        
 Now using VMD to compute SASA Donor = 651 & Acceptor = 654...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 654 & Acceptor = 657...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 657 & Acceptor = 660...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 660 & Acceptor = 639...
rlwrap: Command not found.
 Computing Reorganization Energy from Solvent Accessibility...
 Done!
 ------------------------------------------------------------------- 

 Should we compute the reaction free energy (yes/no)? y

 Two different methods are implemented to estimate heme redox 
 potentials and thereby reaction free energies when an explict
 solvent is presnet:

    (1) Compute the change in electrostatic interaciton energy upon 
        heme oxidaiton using the Linear Interaction Energy method 
        in CPPTRAJ.

    (2) Compute the change in electrostatic interaciton energy upon 
        heme oxidaiton using the Poissonâ€“Boltzmann Surface Area
        method implemented in AmberTools (essentially a Delphi-type
        calculation). In this case, the explicit solvent 
        prepared with the sturcutre is discarded.

    Note that method #1 has two advantages:
        (1) It is considerably faster than method #2

        (2) The overall change in electorstatic energy is decomposed
            into contributions from different groups of residues.
                
 Should we use the LIE or PBSA method (lie/pbsa)? pbsa

 Generating topology for oHEH-651 ...

 Generating topology for rHEH-651 ...

 Generating topology for oHEH-654 ...

 Generating topology for rHEH-654 ...

 Generating topology for oHEH-657 ...

 Generating topology for rHEH-657 ...

 Generating topology for oHEH-660 ...

 Generating topology for rHEH-660 ...

 Generating topology for oHEH-639 ...

 Generating topology for rHEH-639 ...

 Submitting 10 PBSA calculations in parallel
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o651 -p o651.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r651 -p r651.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o654 -p o654.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r654 -p r654.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o657 -p o657.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r657 -p r657.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o660 -p o660.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r660 -p r660.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o639 -p o639.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r639 -p r639.prmtop...>

 Result:
  step=0 HEH-651 EtotOx=-547.502 eV EtotRed=-547.138 eV DEtot=-0.364 eV EelecOx=-361.297 eV EelecRed=-357.960 eV DEelec=-3.337 eV
  step=1 HEH-654 EtotOx=-547.502 eV EtotRed=-547.164 eV DEtot=-0.338 eV EelecOx=-361.297 eV EelecRed=-358.034 eV DEelec=-3.263 eV
  step=2 HEH-657 EtotOx=-547.502 eV EtotRed=-547.030 eV DEtot=-0.472 eV EelecOx=-361.297 eV EelecRed=-357.724 eV DEelec=-3.573 eV
  step=3 HEH-660 EtotOx=-547.502 eV EtotRed=-547.044 eV DEtot=-0.458 eV EelecOx=-361.297 eV EelecRed=-357.785 eV DEelec=-3.512 eV
  step=4 HEH-639 EtotOx=-547.502 eV EtotRed=-547.127 eV DEtot=-0.376 eV EelecOx=-361.297 eV EelecRed=-357.935 eV DEelec=-3.363 eV
 ------------------------------------------------------------------- 

 Should we estimate the electronic coupling from the geometry (yes/no)? y

 Assiging coupling values based on inter-macrocycle planar anlge ... 
 Done!
 ------------------------------------------------------------------- 

 Should we compute the non-adiabatic Marcus-theory rates (yes/no)? y

 Step #0:
    Activation Energy:
        Forward: 2.827E-01 eV
        Reverse: 3.093E-01 eV
    Rates:
        Forward: 1.098E+06 
        Reverse: 3.922E+05
 
 Step #1:
    Activation Energy:
        Forward: 3.424E-01 eV
        Reverse: 2.080E-01 eV
    Rates:
        Forward: 1.820E+06 
        Reverse: 3.302E+08
 
 Step #2:
    Activation Energy:
        Forward: 2.628E-01 eV
        Reverse: 2.771E-01 eV
    Rates:
        Forward: 2.482E+06 
        Reverse: 1.425E+06
 
 Step #3:
    Activation Energy:
        Forward: 2.532E-01 eV
        Reverse: 3.356E-01 eV
    Rates:
        Forward: 5.523E+07 
        Reverse: 2.277E+06
 
 ===================================================================  
 Third: Redox Current Prediction
 ===================================================================  
     
 This division of the BioDC workflow computes, via the analytical
 Derrida formula, the charge diffuction coefficient based on the 
 non-adiabatic Marcus theory rates. The diffusion coefficient is
 then related to the electrical resistance and used in Ohm's law
 to compute the current as a function of applied bias. Note that 
 this approach is only rigorously correct in the limit of zero
 bias.
     
 Found rates.txt, which is needed to proceed!

 We will now compile and run a C-program kindly provided by
 Dr. Fredrik Jansson that has been modified only to 
 interface I/O operations with the BioDC program
cc -Wall -g -O3 -ffast-math  -march=native -fomit-frame-pointer -std=c99     derrida.c   -o derrida
The are 4 electron transfer steps 
1.098000E+06 2.277500E+06
1.820000E+06 3.922078E+05
2.482000E+06 3.301716E+08
5.523000E+07 1.425012E+06
V: 141877.732686
D: 3.331278e-09

 Found D.txt, which is needed to proceed!
 We will at last compute the redox current. 
 To do this, some system-specific information is needed.
        
 Please provide the following parmaeters: 
  Temperature (K)? 300
  Number of Charges per subunit? 2
rlwrap: Command not found.
 
 The length of a subunit of the cytochrome polymer is needed.
  The subunit length measured between the first and the last heme
  specified in LinearizedHemeSequence.txt is 3.43E-07 

  Length of wire (cm)? 3E-5
  Experimental Conductance (S/cm) ? 
   (Enter "0" if not known)         0

 Charge per Subunit Length          = 5.826570e+06 q/cm 
 Cross-Sectional Area               = 1.767146e-14 cm^2
 Charge Density                     = 3.297164e+20 q/cm^2
 Experimental Diffusion Constant    = 0.000000e+00 cm^2/s
 Computed Diffusion Constant        = 3.331278e-09 cm^2/s
    
 Voltage (V) Exp. Current (pA) Computed Current (pA)
      -0.500            -0.000            -2.005E-03
      -0.450            -0.000            -1.805E-03
      -0.400            -0.000            -1.604E-03
      -0.350            -0.000            -1.404E-03
      -0.300            -0.000            -1.203E-03
      -0.250            -0.000            -1.003E-03
      -0.200            -0.000            -8.022E-04
      -0.150            -0.000            -6.016E-04
      -0.100            -0.000            -4.011E-04
      -0.050            -0.000            -2.005E-04
      -0.000            -0.000            -4.453E-19
       0.050             0.000             2.005E-04
       0.100             0.000             4.011E-04
       0.150             0.000             6.016E-04
       0.200             0.000             8.022E-04
       0.250             0.000             1.003E-03
       0.300             0.000             1.203E-03
       0.350             0.000             1.404E-03
       0.400             0.000             1.604E-03
       0.450             0.000             1.805E-03
 Done!
(base) mjgp@alpha:~/ExamplePDBs/7TFS$ 

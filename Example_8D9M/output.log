(base) mjgp@alpha:~/ExamplePDBs/8D9M$ python3 BioDC.py 

 ================================================================== 
                      Weclome to BioDC
           A program that automates and accelerates
             the computation of redox currents in
              (polymeric) multi-heme cytochormes 

            Written by Matthew J. Guberman-Pfeffer
                Last Updated: 05/28/2023

 This research was supported by the National Institute of General 
 Medical Sciences of the National Institutes of Health under award
 1F32GM142247-01A1.
 ================================================================== 

 BioDC presents a highly modular workflow that has three 
 large divisions: 
    (1) Structure Preparaiton & Relaxation
    (2) Energetic Estimation
    (3) Redox Current Prediction
 
 Which of these divisions would you like to perform?
 (Enter zero "0" to be guided through the entire
 workflow.) (0/1/2/3) 0

 ===================================================================  
 First: Structure Preparation & Relaxation
 ===================================================================  
     
 This program requires VMD and the AmberTools package to be 
 in your system's PATH variable. Are they? (yes/no)? y 
 
 Good! Now, here are the PDBs in the present direcotry:

8D9M_B.pdb
8D9M_C.pdb
8D9M_4.pdb
8D9M_5.pdb
8D9M_preped.pdb
8D9M_Creres.pdb
8D9M_3.pdb
8D9M_A.pdb
8D9M.pdb
HEC.pdb
8D9M_2.pdb
8D9M_trimer_reord.pdb
8D9M_Areres.pdb
prot.pdb
8D9M_1.pdb
8D9M_trimer.pdb
8D9M_7.pdb
8D9M_6.pdb
8D9M_Breres.pdb

 Which PDB would you like to setup 
 (omit the .pdb file extension)? 8D9M_preped
 That PDB was found! 

 We need to create a file (ResIndexing.txt) that identifies 
 the IDs of the Cys and His residues bound to the heme macrocycle.
 Would you like to create it automatically or manually (auto/man)? auto

 The automated creation of ResIndexing.txt has two parts:
   1) Writting CreateResIndexing.tcl 
   2) Submitting the TCL script to Visual Molecular Dynamics (VMD)

 The TCL script identifies the Cys and His residues within a 
 distance cutoff of each heme group and assumes that the residues 
 found within that cutoff are bonded to that heme.

 What distance threshold would you liek to use? 
 (recommended = 2.5 angstroms)                  2.5

 Please make sure that the correct residues are identified by, 
 for example, creating representations in VMD with the residue IDs 
 givenon each line of the ResIndexing.txt file. 

 If the wrong residues are identified, the setup later with TLEaP 
 will fail because the bond definitions will be wrong. In this case, 
 please correct the residue IDs and save the changes to 
 CorrectedResIndexing.txt. When you re-run this python scirpt, the
 CorrectedResIndexing.txt file will be detected and used to replace
 ResIndexing.txt. 
                
rlwrap: Command not found.

 Your ResIndexing file will now be used with VMD
 to create the HEH, HIO, and CYO residues.
 
 We will write and submit a script called SetupStructure.tcl to 
 perform this magic.

 CAUTION: The magic of the script is only as good as the information 
 in ResIndexing.txt. If the wrong residue IDs are specified, 
 everything from hereon out will be, put politely, junk!
      
 Shall we venture forward with SetupStructure.tcl (yes/no)? y
rlwrap: Command not found.

 VMD finished. Please check SetupStructure.log for any erros. You may 
 also want to inspect the generated PDBs for the protein,each heme, 
 and each heme propionic acid group.
             
 Now, we need to stitch the edited PDBs of the protein, hemes, 
 and heme propionic acid groups into a single PDB. Then, this 
 re-constructed PDB of the multi-heme protein will be processed
 with TLEaP of the AmberTools package to generate topology and 
 coordinate files.
      
 Prefix for output parm/rst7 8D9M
 Should the structure be prepared with 
 an explicit or implicit solvent (explicit/implicit)? e
  Using a rectangular or an octahedral box (rec/octahed)? rec
  With how much of a solvent buffer (in angstroms)? 15
  And how many Na+ ions; 0 = enough for charge neutrality? 0
  And how many Cl- ions; 0 = enough for charge neutrality? 0

 The re-compiled structure will now be processed with TLEaP.
     
 TLEaP finished! 
 Please inspect the structure to make sure it is correct.
    
 Found 8D9M.prmtop and 8D9M.rst7
 Preparing to relax the geometry
 Running minimization ...
 Minimization finished!

 ===================================================================  
 Second: Energetic Estimation
 ===================================================================


 Is your structure polymeric (yes/no)? y

 The structure preparation stage required you to place all the heme
 residues from all the chains at the end of the PDB with sequential
 numbering. The programs in AmberTools that will be used to estimate 
 the charge transfer energetics want instead the residues to come in 
 the order of the connectiviity; that is, the hemes of chain A should 
 come both any residue in chain B. 

 To oblige this different numbering convention, we'll use the 
 CPPTRAJ of the AmberTools package to re-order the residues. 
 This process will write a new topology and coordinate file, 
 where the latter is of the structure you previously minimized.

 To compute the energetics for heme-to-heme electron transfer. We 
 need to know the linear sequence of hemes that will serve as 
 charge hopping sites. Typically the linear sequence is NOT the 
 sequence of residue IDs in the PDB. We therefore need to specify
 the linear sequence to compute the right electron transfer steps. 
    
 Linear Sequence: 562 559 553 550 547 544 541 844
 ------------------------------------------------------------------- 

 Should we compute the reorganization energy (yes/no)? y
 Found 8D9M_reord.prmtop and min.rst7

 To estimate the reorganization energy (lambda) from the 
 solvent accessible surface area, two steps will be take:
    (1) Convert min.rst7 to a PDB-formatted file using ambpdb 
        Note: This step is skipped because you indicated you 
        have a polymeric structute, When the topology was
        re-ordered to conform to AMBER conventions for 
        multi-chain structures, min.pdb was already 
        created.
             
    (2) Write and submit a TCL script to VMD
        
 Now using VMD to compute SASA Donor = 562 & Acceptor = 559...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 559 & Acceptor = 553...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 553 & Acceptor = 550...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 550 & Acceptor = 547...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 547 & Acceptor = 544...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 544 & Acceptor = 541...
rlwrap: Command not found.
 Now using VMD to compute SASA Donor = 541 & Acceptor = 844...
rlwrap: Command not found.
 Computing Reorganization Energy from Solvent Accessibility...
 Done!
 ------------------------------------------------------------------- 

 Should we compute the reaction free energy (yes/no)? y

 Two different methods are implemented to estimate heme redox 
 potentials and thereby reaction free energies when an explict
 solvent is presnet:

    (1) Compute the change in electrostatic interaciton energy upon 
        heme oxidaiton using the Linear Interaction Energy method 
        in CPPTRAJ.

    (2) Compute the change in electrostatic interaciton energy upon 
        heme oxidaiton using the Poissonâ€“Boltzmann Surface Area
        method implemented in AmberTools (essentially a Delphi-type
        calculation). In this case, the explicit solvent 
        prepared with the sturcutre is discarded.

    Note that method #1 has two advantages:
        (1) It is considerably faster than method #2

        (2) The overall change in electorstatic energy is decomposed
            into contributions from different groups of residues.
                
 Should we use the LIE or PBSA method (lie/pbsa)? pbsa

 Generating topology for oHEH-562 ...

 Generating topology for rHEH-562 ...

 Generating topology for oHEH-559 ...

 Generating topology for rHEH-559 ...

 Generating topology for oHEH-553 ...

 Generating topology for rHEH-553 ...

 Generating topology for oHEH-550 ...

 Generating topology for rHEH-550 ...

 Generating topology for oHEH-547 ...

 Generating topology for rHEH-547 ...

 Generating topology for oHEH-544 ...

 Generating topology for rHEH-544 ...

 Generating topology for oHEH-541 ...

 Generating topology for rHEH-541 ...

 Generating topology for oHEH-844 ...

 Generating topology for rHEH-844 ...

 Submitting 16 PBSA calculations in parallel
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o562 -p o562.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r562 -p r562.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o559 -p o559.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r559 -p r559.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o553 -p o553.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r553 -p r553.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o550 -p o550.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r550 -p r550.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o547 -p o547.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r547 -p r547.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o544 -p o544.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r544 -p r544.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o541 -p o541.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r541 -p r541.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_o844 -p o844.prmtop...>
  Finished: <Popen: returncode: 0 args: 'pbsa -O -i pbsa.key -o pbsa_r844 -p r844.prmtop...>

 Result:
  step=0 HEH-562 EtotOx=-667.257 eV EtotRed=-666.783 eV DEtot=-0.474 eV EelecOx=-417.590 eV EelecRed=-413.691 eV DEelec=-3.899 eV
  step=1 HEH-559 EtotOx=-667.257 eV EtotRed=-666.579 eV DEtot=-0.678 eV EelecOx=-417.590 eV EelecRed=-413.357 eV DEelec=-4.233 eV
  step=2 HEH-553 EtotOx=-667.257 eV EtotRed=-666.622 eV DEtot=-0.635 eV EelecOx=-417.590 eV EelecRed=-413.384 eV DEelec=-4.206 eV
  step=3 HEH-550 EtotOx=-667.257 eV EtotRed=-666.818 eV DEtot=-0.439 eV EelecOx=-417.590 eV EelecRed=-413.444 eV DEelec=-4.146 eV
  step=4 HEH-547 EtotOx=-667.257 eV EtotRed=-666.816 eV DEtot=-0.441 eV EelecOx=-417.590 eV EelecRed=-413.410 eV DEelec=-4.180 eV
  step=5 HEH-544 EtotOx=-667.257 eV EtotRed=-666.892 eV DEtot=-0.365 eV EelecOx=-417.590 eV EelecRed=-413.629 eV DEelec=-3.962 eV
  step=6 HEH-541 EtotOx=-667.257 eV EtotRed=-666.912 eV DEtot=-0.345 eV EelecOx=-417.590 eV EelecRed=-413.835 eV DEelec=-3.756 eV
  step=7 HEH-844 EtotOx=-667.257 eV EtotRed=-666.793 eV DEtot=-0.464 eV EelecOx=-417.590 eV EelecRed=-413.767 eV DEelec=-3.823 eV
 ------------------------------------------------------------------- 

 Should we estimate the electronic coupling from the geometry (yes/no)? y

 Assiging coupling values based on inter-macrocycle planar anlge ... 
 Done!
 ------------------------------------------------------------------- 

 Should we compute the non-adiabatic Marcus-theory rates (yes/no)? y

 Step #0:
    Activation Energy:
        Forward: 3.853E-01 eV
        Reverse: 1.814E-01 eV
    Rates:
        Forward: 2.158E+04 
        Reverse: 5.740E+07
 
 Step #1:
    Activation Energy:
        Forward: 2.508E-01 eV
        Reverse: 2.939E-01 eV
    Rates:
        Forward: 6.289E+07 
        Reverse: 1.188E+07
 
 Step #2:
    Activation Energy:
        Forward: 1.848E-01 eV
        Reverse: 3.806E-01 eV
    Rates:
        Forward: 8.046E+08 
        Reverse: 4.132E+05
 
 Step #3:
    Activation Energy:
        Forward: 3.062E-01 eV
        Reverse: 3.043E-01 eV
    Rates:
        Forward: 4.350E+05 
        Reverse: 4.682E+05
 
 Step #4:
    Activation Energy:
        Forward: 2.666E-01 eV
        Reverse: 3.432E-01 eV
    Rates:
        Forward: 3.231E+07 
        Reverse: 1.668E+06
 
 Step #5:
    Activation Energy:
        Forward: 2.681E-01 eV
        Reverse: 2.880E-01 eV
    Rates:
        Forward: 1.987E+06 
        Reverse: 9.207E+05
 
 Step #6:
    Activation Energy:
        Forward: 3.367E-01 eV
        Reverse: 2.169E-01 eV
    Rates:
        Forward: 2.265E+06 
        Reverse: 2.331E+08
 
 ===================================================================  
 Third: Redox Current Prediction
 ===================================================================  
     
 This division of the BioDC workflow computes, via the analytical
 Derrida formula, the charge diffuction coefficient based on the 
 non-adiabatic Marcus theory rates. The diffusion coefficient is
 then related to the electrical resistance and used in Ohm's law
 to compute the current as a function of applied bias. Note that 
 this approach is only rigorously correct in the limit of zero
 bias.
     
 Found rates.txt, which is needed to proceed!

 We will now compile and run a C-program kindly provided by
 Dr. Fredrik Jansson that has been modified only to 
 interface I/O operations with the BioDC program
cc -Wall -g -O3 -ffast-math  -march=native -fomit-frame-pointer -std=c99     derrida.c   -o derrida
The are 7 electron transfer steps 
2.158000E+04 2.331139E+08
6.289000E+07 5.740086E+07
8.046000E+08 1.188285E+07
4.350000E+05 4.132390E+05
3.231000E+07 4.681638E+05
1.987000E+06 1.668011E+06
2.265000E+06 9.206934E+05
V: -2201.555878
D: 1.026104e-10

 Found D.txt, which is needed to proceed!
 We will at last compute the redox current. 
 To do this, some system-specific information is needed.
        
 Please provide the following parmaeters: 
  Temperature (K)? 300
  Number of Charges per subunit? 4
rlwrap: Command not found.
 
 The length of a subunit of the cytochrome polymer is needed.
  The subunit length measured between the first and the last heme
  specified in LinearizedHemeSequence.txt is 5.88E-07 

  Length of wire (cm)? 3E-5
  Experimental Conductance (S/cm) ? 
   (Enter "0" if not known)         2.67E-7

 Charge per Subunit Length          = 6.803017e+06 q/cm 
 Cross-Sectional Area               = 1.767146e-14 cm^2
 Charge Density                     = 3.849720e+20 q/cm^2
 Experimental Diffusion Constant    = 1.899356e-01 cm^2/s
 Computed Diffusion Constant        = 1.026104e-10 cm^2/s
    
 Voltage (V) Exp. Current (pA) Computed Current (pA)
      -0.500       -133500.000            -7.212E-05
      -0.450       -120150.000            -6.491E-05
      -0.400       -106800.000            -5.770E-05
      -0.350        -93450.000            -5.049E-05
      -0.300        -80100.000            -4.327E-05
      -0.250        -66750.000            -3.606E-05
      -0.200        -53400.000            -2.885E-05
      -0.150        -40050.000            -2.164E-05
      -0.100        -26700.000            -1.442E-05
      -0.050        -13350.000            -7.212E-06
      -0.000            -0.000            -1.601E-20
       0.050         13350.000             7.212E-06
       0.100         26700.000             1.442E-05
       0.150         40050.000             2.164E-05
       0.200         53400.000             2.885E-05
       0.250         66750.000             3.606E-05
       0.300         80100.000             4.327E-05
       0.350         93450.000             5.049E-05
       0.400        106800.000             5.770E-05
       0.450        120150.000             6.491E-05
 Done!
(base) mjgp@alpha:~/ExamplePDBs/8D9M$ 
